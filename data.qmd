---
title: "Your Title"
author: "Your Name"
output: html_document
---

```{r,message = FALSE, warning = FALSE}

# Load necessary libraries
library(ggplot2)
library(readr)
library(dplyr)

# Load the dataset
data <- read_csv("ya_veri.csv")

# Filter out 2018 data
data <- filter(data, year != 2018)

# Function to plot gender distribution
plot_gender_distribution <- function(department_name) {
  department_data <- filter(data, department == department_name)
  
  # Define y-axis limits based on department
  y_limits <- if (department_name == "Computer_Eng") {
    c(0, 140)
  } else {
    c(0, 110)
  }
  
  ggplot(department_data) +
    geom_bar(aes(x = factor(year), y = capacity, fill = "Men"), stat = "identity", position = "stack") +
    geom_bar(aes(x = factor(year), y = capacity * (percentage_women / 100), fill = "Women"), stat = "identity", position = "stack") +
    geom_line(aes(x = factor(year), y = valedictorian * 11, group = 1), color = "purple", linewidth = 0.75) +
    geom_point(aes(x = factor(year), y = valedictorian * 11), color = "purple", size = 2) +
    geom_text(aes(x = factor(year), y = capacity, label = paste0(percentage_men, "%")), 
              vjust = -0.5, color = "pink", size = 3, fontface = "bold") +
    geom_text(aes(x = factor(year), y = capacity * (percentage_women / 100), label = paste0(percentage_women, "%")), 
              vjust = 1.5, color = "navy", size = 3, fontface = "bold") +
    geom_text(aes(x = factor(year), y = valedictorian * 11, label = valedictorian), 
              color = "purple", size = 3, fontface = "bold", vjust = -1.5, hjust = 0.5) +
    scale_y_continuous(name = "Capacity", limits = y_limits, breaks = seq(y_limits[1], y_limits[2], by = 10),
                       sec.axis = sec_axis(~ . / 11, name = "Valedictorians", breaks = seq(1, 10, by = 1))) +
    labs(title = department_name, x = "Year", fill = "Gender") +
    scale_fill_manual(values = c("Women" = "pink", "Men" = "navy")) +
    theme_minimal() +
    theme(plot.title = element_text(hjust = 0.5, size = 12),
          axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
          axis.text.y = element_text(size = 10),
          axis.text.y.right = element_text(color = "purple", size = 10),
          axis.title.y.right = element_text(color = "purple", size = 12))
}

# List of departments
departments <- unique(data$department)

# Create and print plots in a single column
for (dept in departments) {
  print(plot_gender_distribution(dept))
}

```

**Brief Overview**

The graph visualizes annual data for each department, showing:

1.  ***Total student capacity,***

2.  ***Gender distribution (women and men percentages),***

3.  ***Valedictorian (top student) numbers.***

There is a general trend of increasing female student ratios over the years, while valedictorian numbers remain relatively low compared to total capacity.

### **Key Points to Highlight**

#### 1. **Changes in Gender Distribution**

-   **Increase in Female Student Ratios:**\
    Most departments show a steady increase in female student ratios over the years. For example, in `Chemical_Eng`, the female ratio increased from 63.4% in 2019 to 68.3% in 2022.

-   **Decline in Male Student Ratios:**\
    Corresponding to the rise in female ratios, male student ratios show a decrease across most departments.

#### 2. **Valedictorian Trends**

-   Valedictorian numbers are consistent in some departments, such as `Computer_Eng`, but show significant fluctuations in others, such as `Chemical_Eng`.

-   Examples:

    -   `Chemical_Eng`: Valedictorian count dropped from 3 in 2019 to 2 in 2020 and remained stable afterward.

    -   `Computer_Eng`: A noticeable increase in valedictorian numbers in 2022 compared to previous years.

#### 3. **Fluctuations in Total Capacity**

-   **Example:**\
    `Chemical_Eng` had a stable capacity from 2018 to 2021 (82 students) but experienced a 12.2% decrease in 2022 (down to 72 students).

-   Some departments maintain a steady capacity, while others fluctuate significantly.

#### 4. **Notable Differences Between Departments**

-   **`Computer_Eng`:**

    -   Has a higher y-axis limit (140), reflecting a larger student intake compared to other departments.

    -   Shows more consistent trends in valedictorian numbers and gender ratios.

-   **`Chemical_Eng`:**

    -   Exhibits a relatively higher female student ratio compared to other departments.

    -   Shows a decline in total capacity over the years.

### **Insights and Recommendations**

1.  **Increase in Female Student Ratios:**\
    The rising female student ratios indicate either improved educational policies or growing interest among female students in these departments.

2.  **Valedictorian Numbers vs. Capacity:**\
    The low valedictorian numbers relative to total capacity suggest the need for further performance analysis and academic support in specific departments.

3.  **Capacity Variations Between Departments:**\
    Departments like `Computer_Eng` accommodate larger student intakes while maintaining stable valedictorian numbers, which can be studied as a model for scalability.

### 
